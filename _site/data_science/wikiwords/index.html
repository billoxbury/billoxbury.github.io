<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Using topology to help visualise word vectors - Bills.Data</title>
<meta name="description" content="">


  <meta name="author" content="Bill Oxbury">
  
  <meta property="article:author" content="Bill Oxbury">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Bills.Data">
<meta property="og:title" content="Using topology to help visualise word vectors">
<meta property="og:url" content="http://localhost:4000/data_science/wikiwords/">


  <meta property="og:description" content="">



  <meta property="og:image" content="http://localhost:4000/assets/img/2019-09-01/wikimap.jpg">





  <meta property="article:published_time" content="2019-09-01T00:00:00+00:00">






<link rel="canonical" href="http://localhost:4000/data_science/wikiwords/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Bills.Data Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Bills.Data
          <span class="site-subtitle">Exploring ideas in data science</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/bio-photo.jpg" alt="Bill Oxbury" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Bill Oxbury</a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="https://twitter.com/billoxbury" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/billoxbury/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://instagram.com/bills.data" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Using topology to help visualise word vectors">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2019-09-01T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/data_science/wikiwords/" class="u-url" itemprop="url">Using topology to help visualise word vectors
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2019-09-01T00:00:00+00:00">September 1, 2019</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <p><a href="https://billox.shinyapps.io/wikiwords/" target="_blank"><img src="/assets/img/2019-09-01/wikimap.jpg" width="100%" /></a></p>

<p>Vector embeddings are at the heart of image and language models for AI applications including image captioning, machine translation, question-answering and many more. Vector representations of data arise as a natural by-product of neural networks via the states of their internal layers. Vector representations are also inherently geometric, and invite attempts at visualisation as a way to gain insight into data sets. In this post, I will illustrate this for one of the earliest and best known ‘neural’ vector embeddings.</p>

<p><b>word2vec</b> [1] is a neural network-based algorithm for representing words of text by vectors, based on the contextual behaviour of those words in a given training corpus. This post is not about the algorithm — which I will take as given  and just compute the vectors for a load of Wikipedia words. It’s about the question(s): given a cloud of 71,290 <b>word2vec</b> vectors in 200-dimensional space, can we make sense of this point cloud? What does it ‘look’ like, and how are the Wiki-words distributed within it? Can we interact with it visually?</p>

<p>The size of this point cloud makes this a good exercise, as it’s computationally expensive to apply a dimensional reduction such as t-SNE [2], and it’s not really feasible to try plotting so many points in the plane.</p>

<p>So I returned to the <b>mapper</b> construction from topological data analysis, as described in [3] and in <a href="https://billoxbury.github.io/data_science/topological-trick-for-data-visualisation/" target="_blank">my previous blog</a>.</p>

<p><b>mapper</b> says find a suitable open cover of the point cloud — one in which there’s good clustering within the sets of the cover. Then apply heirarchical clustering within each open set, and view all the resulting clusters as nodes of a graph, where edges are drawn between any two nodes for which the corresponding clusters have a point in common.
What you end up with is a much smaller representation of the data, a graph, which is readily visualised and which summarises the distribution of all the points in the cloud.</p>

<p>I’ll come back to the construction in a moment – but first <a href="https://billox.shinyapps.io/wikiwords/" target="_blank">take a look at the result here</a>. We get a graph with 6,273 vertices (of which 4,797 form a giant component). You can select parts of the graph to zoom in on, and then scan the zoomed-in graph with the mouse to see what the word clusters are.</p>

<p>For example, try hovering over points (where ‘point’ = ‘cluster of words’) in the ‘foodie’ island:</p>

<p><img src="/assets/img/2019-09-01/foodie.png" width="100%" /></p>

<p>(The demo has various other knobs and whistles (e.g. choices of graph layout, path-finding) – but I’m not concerned with those here. It is written using <i>R shiny</i> and <i>igraph</i>, as <a href="https://billoxbury.github.io/data_science/coding-interactive-graphics/" target="_blank">described in this blog</a>.)</p>

<p>In the remainder of this post I want to explain the ‘topological’ part of the construction – that is, how I’ve applied <b>mapper</b>.</p>

<p>Following the description in my <a href="https://billoxbury.github.io/data_science/topological-trick-for-data-visualisation/" target="_blank">previous blog</a>, we need a good covering of the point cloud by binning a suitable ‘height’ function. 
By ‘good’ we mean that geometric structures in the cloud should get ‘sliced’ and appear as islands in the sets of the covering. Think of a mountain range, with open sets given by altitude bands. As a whole, the mountains don’t cluster well because they’re all joined at sea level, but when you slice them at a given altitude they separate nicely.</p>

<p>The key observation is that <i>word frequency</i>, as a function on the point cloud, plays the role of altitude in this sense. In other words, the count of a word as it occurs in the Wikipedia corpus. As you’d expect, this has a power law distribution:</p>

<p><img src="/assets/img/2019-09-01/powerlaw.png" width="100%" /></p>

<p>The uncommon words, like technical terms, obscure names, acronyms and so on, are in the top left while the more frequent, common-usage words are in the lower right of the plot. (And I’ll need those coefficients in just a moment.)</p>

<p>The intuition is that natural topics in text (mountains) always comprise a good range of word frequencies — they contain specialist words (coloured red in our graphics) as well as common-usage words (coloured white).</p>

<p>But to make use of word frequency, we need to know that it’s continuous as a function on the point cloud. I’ll justify this heuristically in the following way. First of all, here’s a histogram of point-to-point <b>word2vec</b> distances in a uniform sample of 1,000 words.</p>

<p><img src="/assets/img/2019-09-01/pairwise_dist.png" width="100%" /></p>

<p>On the basis of this, let’s regard two points as ‘close’ if their distance is less than 10. For all point-pairs of distance less than 10, we can plot <b>word2vec</b> distance against frequency distance. It shows empirically that frequency is continuous – points close together always have frequency close together:</p>

<p><img src="/assets/img/2019-09-01/continuity.png" width="100%" /></p>

<p>This is exactly what we need to apply <b>mapper</b>. I use word frequency as my ‘altitude’ function, where the bands are defined exponentially using those coefficients in the power law plot to ensure that all bands in the point cloud are of roughly equal size. Within each band I apply heirarchical clustering, and then edges form as clusters in one band overlap with clusters in an adjacent band.</p>

<p>Finally, having built the graph, we draw it in the plane.</p>

<p>A few extra technical remarks: since the vertices correspond to clusters of points in a vector space, we can represent them by the centroids of those clusters, and then map them into the plane by using a t-SNE projection of the centroids [2].
I suppressed drawing of the edges because they are often long-range and less helpful to the eye. (Though they are meaningful: they represent the many words which inhabit multiple semantic communities.) 
And colour denotes word frequency: white for common words to red for rare words.</p>

<p><strong>References</strong></p>

<ol>
  <li>Google <a href="https://code.google.com/p/word2vec/" target="_blank">word2vec</a></li>
  <li>Laurens van der Maaten, Geoffrey Hinton: <a href="https://www.cs.toronto.edu/~hinton/absps/tsne.pdf" target="_blank">Visualizing Data using t-SNE</a>, Journal of Machine Learning Research 1 (2008).</li>
  <li>Gunnar Carlsson: <a href="https://www.ams.org/journals/bull/2009-46-02/S0273-0979-09-01249-X/S0273-0979-09-01249-X.pdf">Topology and Data</a>, Bull. Amer. Math. Soc. 46 (2009)</li>
</ol>


        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#data-science" class="page__taxonomy-item p-category" rel="tag">data_science</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2019-09-01T00:00:00+00:00">September 1, 2019</time></p>

      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Using+topology+to+help+visualise+word+vectors%20http%3A%2F%2Flocalhost%3A4000%2Fdata_science%2Fwikiwords%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdata_science%2Fwikiwords%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fdata_science%2Fwikiwords%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/data_science/demo-of-the-ttest/" class="pagination--pager" title="A demo of the $t$-test
">Previous</a>
    
    
      <a href="/data_science/crossent/" class="pagination--pager" title="Mean-squared error versus cross-entropy
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">Recent posts</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <div class="archive__item-teaser">
      <img src="/assets/img/2023-03-07/shiny-app.png" alt="">
    </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
      <a href="/data_science/coding-interactive-graphics/" rel="permalink">How to code interactive graphics with R shiny
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-03-07T00:00:00+00:00">March 7, 2023</time>
      </span>
    

    

    
  </p>


    
    <p class="archive__item-excerpt" itemprop="description"><i>Behind the scenes of the blog ‘A Topological Trick for Data Visualisation’
</i></p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <div class="archive__item-teaser">
      <img src="/assets/img/2023-02-22/birdclouds.jpg" alt="">
    </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
      <a href="/environment/language_barriers/" rel="permalink">Language barriers in global conservation
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-02-22T00:00:00+00:00">February 22, 2023</time>
      </span>
    

    

    
  </p>


    
    <p class="archive__item-excerpt" itemprop="description"><i>Conservation of species across language barriers
</i></p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <div class="archive__item-teaser">
      <img src="/assets/img/2022-02-10/browse_topics.png" alt="">
    </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
      <a href="/data_science/plosone-topic-tree/" rel="permalink">Navigating the PLOS ONE topic tree
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-02-10T00:00:00+00:00">February 10, 2022</time>
      </span>
    

    

    
  </p>


    
    <p class="archive__item-excerpt" itemprop="description"><i>Crawling the PLOS ONE site to figure out the tree of all subtopics
</i></p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/billoxbury" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/billoxbury/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://instagram.com/bills.data" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Bills.Data. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






<script type="text/javascript" async
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
       processEscapes: true
     },
     "HTML-CSS": { availableFonts: ["TeX"] }
   });
</script>


  </body>
</html>
